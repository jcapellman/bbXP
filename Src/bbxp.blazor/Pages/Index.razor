@page "/"
@page "/{year}/{month}/{day}/{postURL}"

@inject bbxp.lib.DAL.BbxpDbContext dbContext
@inject bbxp.lib.Interfaces.IPostService pService

@foreach (var post in posts)
{
    <Post PostItem=@post SinglePost=@SinglePost />
}

@code {
    private List<bbxp.lib.Transports.Posts.PostResponseItem> posts;

    [Parameter]
    public string postURL { get; set; }

    [Parameter]
    public int year { get; set; }

    [Parameter]
    public int month { get; set; }

    [Parameter]
    public int day { get; set; }

    private bool SinglePost;

    protected override void OnInitialized()
    {
        if (string.IsNullOrEmpty(postURL))
        {
            posts = pService.GetHomeListing(dbContext);
        } else
        {
            posts = pService.GetPost(dbContext, postURL);

            SinglePost = true;
        }
    }
}